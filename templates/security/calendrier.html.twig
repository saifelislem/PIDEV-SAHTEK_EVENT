{% extends 'admin.html.twig' %}

{% block title %}Calendrier des Événements{% endblock %}

{% block body %}
    <div class="container-fluid">
        <h1 class="h3 mb-4 text-gray-800">Calendrier des Événements</h1>

        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">{{ message }}</div>
        {% endfor %}

        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Calendrier des Événements</h6>
            </div>
            <div class="card-body">
                <div id="calendrier" style="width: 80%; margin: auto;"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Script loaded');
            const calendarEl = document.getElementById('calendrier');
            console.log('Calendar element:', calendarEl);
            console.log('Events data:', {{ data|raw }});
            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                initialDate: new Date(),
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                events: {{ data|raw }},
                editable: false,
                eventContent: function(arg) {
                    return {
                        html: `<div><b>${arg.event.title}</b><br>${arg.event.extendedProps.lieu || ''}</div>`
                    };
                }
            });
            console.log('Calendar initialized');
            calendar.render();
            console.log('Calendar rendered');
        });
    </script>
{% endblock %}